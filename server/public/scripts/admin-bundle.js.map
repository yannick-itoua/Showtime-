{"version":3,"file":"scripts/admin-bundle.js","mappings":"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","sources":["webpack://showtime client/./src/scripts/admin.js"],"sourcesContent":["//admin.js\r\nconst socket = io();\r\nconst listDiv = document.getElementById('list');\r\nconst contentDiv = document.getElementById('content');\r\nconst createItemBtn = document.getElementById('create');\r\nconst userDiv=document.getElementById('userId');\r\nconst log=document.getElementById('logout');\r\n\r\nconst displayItems = async () => {\r\n    const requestOptions = {\r\n      method: 'GET'\r\n    };\r\n    const response = await fetch('/item/', requestOptions);\r\n    if (!response.ok) {\r\n      throw new Error('Response not ok');\r\n    }\r\n    const items = await response.json();\r\n    let html = '<p>Les spectacles:</p><ul>';\r\n    items.forEach(item => {\r\n      html += `<li class=\"item\">${item.description} : ${item.capacity} places \r\n      <button class=\"modify\" data-id=\"${item._id}\">Modifier</button> <button class=\"delete\" data-id=\"${item._id}\">Supprimer</button></li>`;\r\n    });\r\n    listDiv.innerHTML = html;\r\n\r\n    const deleteButtons = document.querySelectorAll('.delete');\r\n    deleteButtons.forEach(deleteButton => {\r\n      deleteButton.addEventListener('click', () => {\r\n        const itemId = deleteButton.getAttribute('data-id');\r\n        deleteItem(itemId, deleteButton);\r\n      });\r\n    });\r\n    \r\n    const modifyButtons = document.querySelectorAll('.modify');\r\n    modifyButtons.forEach(button => {\r\n      button.addEventListener('click', () => {\r\n        const itemId = button.getAttribute('data-id');\r\n        updateItem(itemId, button);\r\n      });\r\n    });\r\n};\r\n\r\nconst createItem = async () => {\r\n    const description = document.getElementById('desc').value;\r\n    const capacity = document.getElementById('capacity').value;\r\n    if (!description) {\r\n      contentDiv.textContent = 'La description du spectacle ne peut pas être vide.';\r\n      return;\r\n    }\r\n    if (!capacity) {\r\n      contentDiv.textContent = 'La capacité du spectacle ne peut pas être vide.';\r\n      return;\r\n    }\r\n    const requestOptions = {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json'\r\n      },\r\n      body: JSON.stringify({description,capacity})\r\n    };\r\n    const response = await fetch('/item/', requestOptions);\r\n    if (!response.ok) {\r\n      throw new Error('Response not ok');\r\n    }\r\n    const createdItem = await response.json();\r\n    contentDiv.textContent = `Spectacle avec id ${createdItem._id} a été créé.`;\r\n    displayItems();\r\n    clearFields();\r\n    socket.emit('itemCreated',createdItem);\r\n};\r\n\r\nconst deleteItem = async (itemId, button) => {\r\n  const requestOptions = {\r\n    method: 'DELETE'\r\n  };\r\n  const response = await fetch(`/item/${itemId}`, requestOptions);\r\n  if (response.ok) {\r\n    contentDiv.textContent = `Spectacle avec id ${itemId} a été supprimé.`;\r\n    button.parentNode.remove();\r\n    socket.emit('itemDeleted', itemId);\r\n  } else {\r\n    contentDiv.textContent = `Spectacle avec id ${itemId} ne peut pas être supprimé`;\r\n  }\r\n  displayItems();\r\n};\r\n\r\nconst updateItem = async (itemId, button) => {\r\n  const newDescription = prompt('Enter a new description for the item:');\r\n  if (!newDescription) {\r\n    contentDiv.textContent = 'New item description cannot be empty.';\r\n    return;\r\n  }\r\n  const requestOptions = {\r\n    method: 'PUT',\r\n    headers: {\r\n      'Content-Type': 'application/json'\r\n    },\r\n    body: JSON.stringify({ newDescription })\r\n  };\r\n  const response = await fetch(`/item/update/${itemId}`, requestOptions);\r\n  if (!response.ok) {\r\n    const error = await response.json();\r\n    contentDiv.textContent = error.message;\r\n    return;\r\n  }\r\n  const updatedItem = await response.json();\r\n  contentDiv.textContent = `Item with id ${updatedItem._id} was updated.`;\r\n  displayItems();\r\n  socket.emit(\"itemModified\",updatedItem);\r\n};\r\n\r\nconst getUser = async () => {\r\n  const requestOptions = {\r\n    method: 'GET',\r\n  };\r\n  const response = await fetch('/user/me', requestOptions);\r\n  if (!response.ok) {\r\n    throw new Error('Failed to get user.');\r\n  }\r\n  const user = await response.json();\r\n  userDiv.textContent = `${user.name}` || '';\r\n    displayItems();\r\n  return user;\r\n};\r\n   \r\nconst logout = async () => {\r\n  const requestOptions = {\r\n                         method :'GET',\r\n                       };\r\n  const response = await fetch(`/access/logout`, requestOptions);\r\n  if (response.ok) {\r\n    window.location.href= '/access/login';\r\n  }\r\n};\r\n\r\nconst clearFields = () => {\r\n    const descriptionInput = document.getElementById('desc');\r\n    const capacityInput = document.getElementById('capacity');\r\n    descriptionInput.value = '';\r\n    capacityInput.value = '';\r\n};\r\n\r\ncreateItemBtn.addEventListener('click', createItem);\r\nlog.addEventListener('click',logout);\r\ngetUser();\r\ndisplayItems();\r\n\r\nsocket.on('itemBorrowed', (itemId) => {\r\n  contentDiv.textContent = `Spectacle avec id ${itemId} est réservé.`;\r\n  displayItems();\r\n});\r\nsocket.on('itemReleased', (itemId) => {\r\n  contentDiv.textContent = `Spectacle avec id ${itemId} est libéré .`;\r\n  displayItems();\r\n});\r\n\r\nsocket.on('capacityZero', (itemId) => {\r\n  displayItems();\r\n});"],"names":["socket","io","listDiv","document","getElementById","contentDiv","createItemBtn","userDiv","log","displayItems","requestOptions","method","response","fetch","ok","Error","items","json","html","forEach","item","description","capacity","_id","innerHTML","deleteButtons","querySelectorAll","deleteButton","addEventListener","itemId","getAttribute","deleteItem","modifyButtons","button","updateItem","createItem","value","textContent","headers","body","JSON","stringify","createdItem","clearFields","emit","parentNode","remove","newDescription","prompt","error","message","updatedItem","getUser","user","name","logout","window","location","href","descriptionInput","capacityInput","on"],"sourceRoot":""}